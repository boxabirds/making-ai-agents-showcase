# Task 6: Abstractive Verification

## Design Reference
- [tech-design.md §5](../../design/citation-eval/tech-design.md#5-abstractive-verification-design)
- [tech-design.md §3.2.5](../../design/citation-eval/tech-design.md#325-stage-4b-abstractive-verification)

## Objective
Verify abstractive claims using LLM-as-judge for semantic understanding.

## Requirements

### R6.1: Judge Prompt
Implement prompt template from tech-design.md §5.2:
- Chain-of-thought reasoning
- Binary output (supports/not)
- Confidence indication

### R6.2: When to Use
Per tech-design.md §5.1:
- Claim classified as abstractive
- Claim classified as unknown AND extractive check inconclusive
- Explicit flag for high-stakes evaluation

### R6.3: Response Parsing
Parse JSON response with fallback for malformed output

### R6.4: Model Selection
Per tech-design.md §5.4:
- Default: gpt-4o-mini
- Low confidence: escalate to gpt-4o

## Dependencies
- Task 2: Structural validation (provides cited content)

## Test Plan

| Test | Claim | Code | Expected |
|------|-------|------|----------|
| Clear support | "Prevents replay attacks" | Nonce validation code | SUPPORTS |
| Clear non-support | "Uses OAuth" | Username/password auth | NOT_SUPPORTS |
| Inference required | "Handles errors gracefully" | try/except blocks | SUPPORTS (inferred) |
| Overstated | "Fully secure" | Basic validation | NOT_SUPPORTS |

## Acceptance Criteria
- [ ] Prompt follows tech-design.md §5.2 template
- [ ] JSON parsing handles malformed responses
- [ ] Confidence field populated
- [ ] Reasoning field explains verdict
- [ ] Token usage tracked per call
