<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Line Highlighting Test</title>
    
    <!-- Highlight.js CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/github.min.css">
    
    <!-- Highlight.js core library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    
    <!-- Python language support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/python.min.js"></script>
    
    <!-- Line numbers plugin -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.9.0/highlightjs-line-numbers.min.js"></script>
    
    <style>
        .hljs-ln-numbers {
            text-align: right;
            color: #999;
            border-right: 1px solid #ddd;
            padding-right: 10px !important;
            padding-left: 5px !important;
            width: 50px;
            white-space: nowrap;
        }
        
        .hljs-ln-code {
            padding-left: 15px !important;
        }
        
        .hljs-ln-line.highlighted {
            background-color: yellow !important;
        }
        
        .test-container {
            margin: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>Test Case: Lines 25-30 should be highlighted</h2>
        <pre><code id="test-code" class="language-python">from pathlib import Path
import json
import re
from openai import OpenAI
import inspect
import ast
import sys
import os
import logging
from typing import Dict, Any, List, Optional, Tuple
from datetime import datetime

# Configure logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# Suppress httpx logging
logging.getLogger("httpx").setLevel(logging.WARNING)
logging.getLogger("openai").setLevel(logging.WARNING)
logging.getLogger("httpcore").setLevel(logging.WARNING)

class TechWriterReActAgent:
    def __init__(self, api_key: str = None, model: str = "gpt-4o-mini", verbose: bool = False):
        """Initialize the Tech Writer ReAct Agent.
        
        Args:
            api_key: OpenAI API key (or use environment variable)
            model: Model to use for generation
            verbose: Whether to print verbose output
        """</code></pre>
        
        <button onclick="testHighlight()">Test Highlight Lines 25-30</button>
        <div id="debug-output"></div>
    </div>
    
    <script>
        // Apply syntax highlighting
        document.addEventListener('DOMContentLoaded', function() {
            const codeEl = document.getElementById('test-code');
            hljs.highlightElement(codeEl);
            hljs.lineNumbersBlock(codeEl);
        });
        
        function testHighlight() {
            const codeEl = document.getElementById('test-code');
            const debugEl = document.getElementById('debug-output');
            
            // Clear previous highlights
            document.querySelectorAll('.hljs-ln-line').forEach(line => {
                line.classList.remove('highlighted');
            });
            
            // Find all line rows
            const lineRows = codeEl.querySelectorAll('.hljs-ln-line');
            debugEl.innerHTML = `<h3>Debug Info:</h3>`;
            debugEl.innerHTML += `<p>Total line rows found: ${lineRows.length}</p>`;
            
            // Highlight lines 25-30 (which should be rows 25-30 since we start at line 1)
            const startLine = 25;
            const endLine = 30;
            
            lineRows.forEach((row, index) => {
                const lineNum = index + 1;
                
                // Try to get the displayed line number from the DOM
                const lineNumberCell = row.querySelector('.hljs-ln-numbers');
                const displayedLineNum = lineNumberCell ? lineNumberCell.textContent.trim() : 'N/A';
                
                if (index < 5 || (lineNum >= startLine && lineNum <= endLine)) {
                    debugEl.innerHTML += `<p>Row ${index}: Line ${lineNum}, Displayed: ${displayedLineNum}</p>`;
                }
                
                if (lineNum >= startLine && lineNum <= endLine) {
                    row.classList.add('highlighted');
                }
            });
            
            debugEl.innerHTML += `<p><strong>Lines ${startLine}-${endLine} should be highlighted in yellow</strong></p>`;
        }
    </script>
</body>
</html>